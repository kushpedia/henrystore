{% extends 'partials/base.html' %}
{% load humanize %}
{% load static %}

{% block content %}
<main class="main">
    <div class="page-header breadcrumb-wrap">
        <div class="container">
            <div class="breadcrumb">
                <a href="{% url 'core:index' %}" rel="nofollow"><i class="fi-rs-home mr-5"></i>Home</a>
                <span></span> Deals of the Day
            </div>
        </div>
    </div>
    
    <div class="container mb-30 mt-30">
        <div class="row">
            <div class="col-12">
                <!-- Header Section -->
                <div class="section-title d-flex justify-content-between align-items-center mb-30">
                    <h2 class="m-0">Deals Of The Day</h2>
                    
                </div>
                
                <!-- Deals Count -->
                <div class="mb-30">
                    <p class="mb-0">We found <strong class="text-brand">{{ page_obj.paginator.count }}</strong> active deal{{ page_obj.paginator.count|pluralize:"s" }}!</p>
                </div>
                
                <!-- Deals Grid -->
                <div class="row">
					{% for d in deals_products %}
					<div class="col-xl-3 col-lg-4 col-md-6">
						<div class="product-cart-wrap style-2">
							
							<div class="product-img-action-wrap">
								<div class="product-badges product-badges-position product-badges-mrg">
									<span class="hot">-{{d.get_precentage|floatformat:0}} %</span>
								</div>
								<div class="product-img">
									<a href="{% url 'core:product-detail' d.pid %}">
										<img src="{{d.image.url}}" alt="" style="height:350px;" />
									</a>
								</div>
							</div>
							<div class="product-content-wrap">
								<div class="deals-countdown-wrap">
									<div class="deals-countdown" data-countdown='{{ d.deal_end_date|date:"Y/m/d H:i:s" }}''></div>
								</div>
								<div class="deals-content">
									<h2><a href="{% url 'core:product-detail' d.pid %}">{{d.title}}</a></h2>
									
									<div class="product-rate-cover">
										<div class="product-rate d-inline-block">
											<div class="product-rating" style="width: 90%"></div>
										</div>
										<span class="font-small ml-5 text-muted"> {{d.get_average_rating|floatformat:1}} ({{d.get_total_ratings}} Reviews)</span>
									</div>
									<div>
										<span class="font-small text-muted">By <a href="{% url 'core:vendor-detail' d.vendor.vid %}">{{d.vendor.title}}</a></span>
									</div>
									<div class="product-card-bottom">
										<div class="product-price">
											<span>Ksh </span><span class="current-product-price-{{ d.id }}">  {{d.price }}</span>
											<br/>

											<span class="old-price">Ksh {{d.old_price}}</span>
										</div>
										<div class="add-cart">
											
											
											<div class="d-flex">
												<a href="{% url 'core:product-detail' d.pid %}"  style="border: none;" class="btn btn-sm btn-primary">
													<i class="bi bi-amd"></i>View Details
												</a>
												
											</div>
										
											</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					{% endfor %}
				</div>
                
                <!-- Pagination -->
                {% if page_obj.paginator.num_pages > 1 %}
                <div class="pagination-area mt-20 mb-20">
                    <nav aria-label="Page navigation example">
                        <ul class="pagination justify-content-center">
                            {% if page_obj.has_previous %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ page_obj.previous_page_number }}">
                                    <i class="fi-rs-arrow-small-left"></i>
                                </a>
                            </li>
                            {% endif %}
                            
                            {% for num in page_obj.paginator.page_range %}
                                {% if page_obj.number == num %}
                                <li class="page-item active">
                                    <a class="page-link" href="#">{{ num }}</a>
                                </li>
                                {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                                <li class="page-item">
                                    <a class="page-link" href="?page={{ num }}">{{ num }}</a>
                                </li>
                                {% endif %}
                            {% endfor %}
                            
                            {% if page_obj.has_next %}
                            <li class="page-item">
                                <a class="page-link" href="?page={{ page_obj.next_page_number }}">
                                    <i class="fi-rs-arrow-small-right"></i>
                                </a>
                            </li>
                            {% endif %}
                        </ul>
                    </nav>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</main>
{% endblock %}

